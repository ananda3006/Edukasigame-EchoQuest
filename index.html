<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EchoQuest - Sang Penjaga Suara Digital</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #2d1b69 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        .game-container {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }
        
        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }
        
        .header {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 2rem;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .game-title {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(45deg, #00f5ff, #ff00ff, #ffff00);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s ease-in-out infinite;
            margin-bottom: 0.5rem;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #00f5ff;
            margin-bottom: 1rem;
        }
        
        .main-content {
            flex: 1;
            position: relative;
            z-index: 10;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .screen {
            display: none;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .player-setup {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 3rem;
            border: 2px solid rgba(0, 245, 255, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .form-group {
            margin-bottom: 2rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #00f5ff;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .avatar-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .avatar-option {
            aspect-ratio: 1;
            border: 3px solid transparent;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .avatar-option:hover, .avatar-option.selected {
            border-color: #00f5ff;
            background: rgba(0, 245, 255, 0.2);
            transform: scale(1.05);
        }
        
        .btn {
            background: linear-gradient(45deg, #00f5ff, #ff00ff);
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 245, 255, 0.3);
        }
        
        .ai-companion {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(0, 245, 255, 0.3), rgba(255, 0, 255, 0.3));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
            z-index: 100;
            border: 3px solid rgba(0, 245, 255, 0.5);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .ai-speech {
            position: fixed;
            bottom: 160px;
            right: 2rem;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 1.5rem;
            max-width: 300px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            display: none;
            z-index: 101;
        }
        
        .ai-speech.show {
            display: block;
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .level-map {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .level-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid rgba(0, 245, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .level-card:hover {
            transform: translateY(-5px);
            border-color: #00f5ff;
            box-shadow: 0 15px 30px rgba(0, 245, 255, 0.2);
        }
        
        .level-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .level-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .level-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #00f5ff;
        }
        
        .level-description {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .game-screen {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 3rem;
            border: 2px solid rgba(0, 245, 255, 0.3);
        }
        
        .question-container {
            margin: 2rem 0;
        }
        
        .question {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: #00f5ff;
        }
        
        .options {
            display: grid;
            gap: 1rem;
        }
        
        .option {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option:hover {
            background: rgba(0, 245, 255, 0.2);
            border-color: #00f5ff;
        }
        
        .option.correct {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }
        
        .option.incorrect {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff0000;
        }
        
        .score-display {
            position: fixed;
            top: 2rem;
            left: 2rem;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1rem;
            border: 2px solid rgba(0, 245, 255, 0.3);
            z-index: 100;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00f5ff, #ff00ff);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .cutscene {
            text-align: center;
            padding: 3rem;
        }
        
        .cutscene-text {
            font-size: 1.5rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            animation: typewriter 3s steps(50) 1s both;
        }
        
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        
        .certificate {
            background: linear-gradient(135deg, #1a1a3e, #2d1b69);
            border: 3px solid #00f5ff;
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            margin: 2rem auto;
            max-width: 600px;
        }
        
        .certificate-title {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            color: #00f5ff;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 768px) {
            .game-title {
                font-size: 2rem;
            }
            
            .player-setup {
                padding: 2rem;
            }
            
            .ai-companion {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
            
            .ai-speech {
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="stars" id="stars"></div>
        
        <header class="header">
            <h1 class="game-title">EchoQuest</h1>
            <p class="subtitle">Sang Penjaga Suara Digital</p>
        </header>
        
        <div class="score-display" id="scoreDisplay" style="display: none;">
            <div>🏆 Skor: <span id="currentScore">0</span></div>
            <div>⭐ Level: <span id="currentLevel">1</span></div>
        </div>
        
        <main class="main-content">
            <!-- Setup Screen -->
            <div class="screen active" id="setupScreen">
                <div class="player-setup">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: #00f5ff;">Persiapan Petualangan</h2>
                    
                    <div class="form-group">
                        <label for="playerName">Nama Pemain:</label>
                        <input type="text" id="playerName" placeholder="Masukkan nama kamu">
                    </div>
                    
                    <div class="form-group">
                        <label for="playerClass">Kelas & Jurusan:</label>
                        <select id="playerClass">
                            <option value="">Pilih kelas dan jurusan</option>
                            <option value="XI TKJ A">XI TKJ 1</option>
                            <option value="XI TKJ B">XI TKJ 2</option>
                            <option value="XI RPL A">XI RPL 1</option>
                            <option value="XI RPL B">XI RPL 2</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Pilih Avatar:</label>
                        <div class="avatar-selection">
                            <div class="avatar-option" data-avatar="🤖">🤖</div>
                            <div class="avatar-option" data-avatar="👨‍💻">👨‍💻</div>
                            <div class="avatar-option" data-avatar="👩‍💻">👩‍💻</div>
                            <div class="avatar-option" data-avatar="🦾">🦾</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="difficulty">Tingkat Kesulitan:</label>
                        <select id="difficulty">
                            <option value="easy">Mudah</option>
                            <option value="medium">Sedang</option>
                            <option value="hard">Sulit</option>
                        </select>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn" onclick="startGame()">Mulai Petualangan</button>
                    </div>
                </div>
            </div>
            
            <!-- Intro Cutscene -->
            <div class="screen" id="introScreen">
                <div class="cutscene">
                    <h2 style="color: #ff00ff; margin-bottom: 2rem;">🚨 PERINGATAN SISTEM 🚨</h2>
                    <div class="cutscene-text">
                        Dunia komunikasi digital sedang dalam bahaya! "Virus Hening" telah menyerang jaringan VoIP global, memutus semua koneksi suara digital. Sebagai Guardian of Echo, kamu adalah harapan terakhir untuk memulihkan sistem komunikasi dunia!
                    </div>
                    <button class="btn" onclick="showLevelMap()">Terima Misi</button>
                </div>
            </div>
            
            <!-- Level Map -->
            <div class="screen" id="levelMapScreen">
                <h2 style="text-align: center; margin-bottom: 2rem; color: #00f5ff;">Peta Petualangan</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="gameProgress"></div>
                </div>
                
                <div class="level-map">
                    <div class="level-card" onclick="startLevel(1)">
                        <div class="level-icon">🏝️</div>
                        <div class="level-title">Level 1: Pulau Suara</div>
                        <div class="level-description">Pelajari dasar-dasar VoIP dan sejarahnya</div>
                    </div>
                    
                    <div class="level-card locked" id="level2">
                        <div class="level-icon">🏙️</div>
                        <div class="level-title">Level 2: Kota Kabel</div>
                        <div class="level-description">Kenali perangkat keras & lunak VoIP</div>
                    </div>
                    
                    <div class="level-card locked" id="level3">
                        <div class="level-icon">🗼</div>
                        <div class="level-title">Level 3: Menara Protokol</div>
                        <div class="level-description">Pahami protokol VoIP dan cara kerjanya</div>
                    </div>
                    
                    <div class="level-card locked" id="level4">
                        <div class="level-icon">🏰</div>
                        <div class="level-title">Level 4: Benteng Keamanan</div>
                        <div class="level-description">Pelajari ancaman dan perlindungan VoIP</div>
                    </div>
                    
                    <div class="level-card locked" id="level5">
                        <div class="level-icon">🏛️</div>
                        <div class="level-title">Level 5: Aula Aplikasi</div>
                        <div class="level-description">Terapkan VoIP dalam berbagai bidang</div>
                    </div>
                </div>
            </div>
            
            <!-- Game Screen -->
            <div class="screen" id="gameScreen">
                <div class="game-screen">
                    <h2 id="levelTitle" style="text-align: center; color: #00f5ff; margin-bottom: 2rem;"></h2>
                    
                    <div id="materialSection" style="margin-bottom: 2rem;">
                        <h3 style="color: #ff00ff; margin-bottom: 1rem;">📚 Materi Pembelajaran</h3>
                        <div id="materialContent" style="background: rgba(255, 255, 255, 0.1); padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem;"></div>
                    </div>
                    
                    <div class="question-container">
                        <h3 style="color: #ff00ff; margin-bottom: 1rem;">❓ Tantangan</h3>
                        <div class="question" id="questionText"></div>
                        <div class="options" id="optionsContainer"></div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="btn" id="nextButton" onclick="nextQuestion()" style="display: none;">Lanjut</button>
                        <button class="btn" onclick="showLevelMap()" style="margin-left: 1rem;">Kembali ke Peta</button>
                    </div>
                </div>
            </div>
            
            <!-- Final Screen -->
            <div class="screen" id="finalScreen">
                <div class="cutscene">
                    <h2 style="color: #00ff00; margin-bottom: 2rem;">🎉 MISI BERHASIL! 🎉</h2>
                    <div class="cutscene-text">
                        Selamat! Kamu telah berhasil mengalahkan Virus Hening dan memulihkan jaringan VoIP global. Komunikasi digital kembali normal berkat keahlianmu!
                    </div>
                    
                    <div class="certificate">
                        <div class="certificate-title">🏆 SERTIFIKAT DIGITAL 🏆</div>
                        <h3>Guardian of Echo</h3>
                        <p style="margin: 1rem 0;">Diberikan kepada:</p>
                        <h2 id="certificateName" style="color: #00f5ff;"></h2>
                        <p style="margin: 1rem 0;">Sebagai Penjaga Komunikasi Digital Masa Depan</p>
                        <p>Skor Akhir: <span id="finalScore"></span></p>
                    </div>
                    
                    <button class="btn" onclick="restartGame()">Main Lagi</button>
                </div>
            </div>
        </main>
        
        <!-- AI Companion -->
        <div class="ai-companion" id="aiCompanion" onclick="toggleAISpeech()">
            🤖
        </div>
        
        <div class="ai-speech" id="aiSpeech">
            <div id="aiMessage">Halo! Aku ECHO, AI pendampingmu. Klik aku kapan saja untuk mendapat bantuan!</div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            playerName: '',
            playerClass: '',
            playerAvatar: '',
            difficulty: 'medium',
            currentLevel: 1,
            score: 0,
            completedLevels: [],
            currentQuestionIndex: 0
        };

        // Game Data
        const levels = {
            1: {
                title: "Level 1: Pulau Suara",
                material: "VoIP (Voice over Internet Protocol) adalah teknologi yang memungkinkan komunikasi suara melalui jaringan internet. Teknologi ini pertama kali dikembangkan pada tahun 1995 dan telah merevolusi cara kita berkomunikasi, mengubah panggilan telepon tradisional menjadi data digital yang dapat dikirim melalui internet.",
                questions: [
                    {
                        question: "Apa kepanjangan dari VoIP?",
                        options: ["Voice over Internet Protocol", "Video over Internet Protocol", "Virtual over Internet Protocol", "Voice on Internet Platform"],
                        correct: 0
                    },
                    {
                        question: "Kapan teknologi VoIP pertama kali dikembangkan?",
                        options: ["1990", "1995", "2000", "2005"],
                        correct: 1
                    },
                    {
                        question: "Apa keuntungan utama VoIP dibanding telepon tradisional?",
                        options: ["Lebih mahal", "Kualitas suara lebih buruk", "Biaya lebih murah", "Tidak bisa digunakan"],
                        correct: 2
                    }
                ]
            },
            2: {
                title: "Level 2: Kota Kabel",
                material: "Perangkat VoIP terdiri dari hardware dan software. Hardware meliputi IP Phone (telepon khusus VoIP), Gateway (penghubung jaringan), dan Server VoIP. Software meliputi Softphone (aplikasi telepon di komputer/HP), codec untuk kompresi suara, dan sistem manajemen panggilan.",
                questions: [
                    {
                        question: "Apa fungsi utama Gateway dalam sistem VoIP?",
                        options: ["Menyimpan data", "Menghubungkan jaringan yang berbeda", "Mengompres suara", "Mengatur panggilan"],
                        correct: 1
                    },
                    {
                        question: "Softphone adalah...",
                        options: ["Telepon fisik", "Aplikasi telepon di komputer", "Perangkat keras", "Kabel jaringan"],
                        correct: 1
                    },
                    {
                        question: "Codec dalam VoIP berfungsi untuk...",
                        options: ["Mengatur panggilan", "Mengompres dan dekompresi suara", "Menyimpan kontak", "Mengatur jaringan"],
                        correct: 1
                    }
                ]
            },
            3: {
                title: "Level 3: Menara Protokol",
                material: "Protokol VoIP utama adalah SIP (Session Initiation Protocol) untuk mengatur panggilan, RTP (Real-time Transport Protocol) untuk mengirim data suara, dan H.323 sebagai standar komunikasi multimedia. SIP paling populer karena fleksibel dan mudah diintegrasikan.",
                questions: [
                    {
                        question: "Protokol apa yang digunakan untuk mengatur panggilan VoIP?",
                        options: ["RTP", "SIP", "HTTP", "FTP"],
                        correct: 1
                    },
                    {
                        question: "RTP berfungsi untuk...",
                        options: ["Mengatur panggilan", "Mengirim data suara real-time", "Keamanan", "Kompresi"],
                        correct: 1
                    },
                    {
                        question: "Mengapa SIP lebih populer dari H.323?",
                        options: ["Lebih rumit", "Lebih fleksibel dan mudah diintegrasikan", "Lebih lambat", "Lebih mahal"],
                        correct: 1
                    }
                ]
            },
            4: {
                title: "Level 4: Benteng Keamanan",
                material: "Ancaman VoIP meliputi spam call, DoS attack yang membuat server down, dan penyadapan panggilan. Perlindungan dilakukan dengan enkripsi data suara, firewall untuk memblokir akses tidak sah, VPN untuk koneksi aman, dan sistem autentikasi yang kuat.",
                questions: [
                    {
                        question: "Apa itu DoS attack pada VoIP?",
                        options: ["Panggilan spam", "Serangan yang membuat server tidak dapat diakses", "Penyadapan", "Virus"],
                        correct: 1
                    },
                    {
                        question: "Cara melindungi VoIP dari penyadapan adalah...",
                        options: ["Menggunakan enkripsi", "Mematikan firewall", "Menggunakan password lemah", "Tidak menggunakan VPN"],
                        correct: 0
                    },
                    {
                        question: "Fungsi firewall dalam sistem VoIP adalah...",
                        options: ["Mengompres suara", "Memblokir akses tidak sah", "Mengatur panggilan", "Menyimpan data"],
                        correct: 1
                    }
                ]
            },
            5: {
                title: "Level 5: Aula Aplikasi",
                material: "VoIP diterapkan di berbagai bidang: di rumah untuk panggilan murah, di bisnis untuk sistem telepon kantor, di call center untuk layanan pelanggan, dan di pendidikan untuk pembelajaran jarak jauh. Contoh aplikasi populer: Skype, WhatsApp Call, Zoom, dan Microsoft Teams.",
                questions: [
                    {
                        question: "Contoh penerapan VoIP di bidang pendidikan adalah...",
                        options: ["Call center", "Video conference pembelajaran", "Sistem keamanan", "Game online"],
                        correct: 1
                    },
                    {
                        question: "WhatsApp Call menggunakan teknologi...",
                        options: ["Telepon tradisional", "VoIP", "Radio", "Satelit"],
                        correct: 1
                    },
                    {
                        question: "Keuntungan VoIP untuk bisnis adalah...",
                        options: ["Lebih mahal", "Fitur lebih lengkap dan biaya lebih murah", "Kualitas buruk", "Sulit digunakan"],
                        correct: 1
                    }
                ]
            }
        };

        const aiMessages = {
            welcome: "Selamat datang di EchoQuest! Aku akan membantumu memahami dunia VoIP. Siap memulai petualangan?",
            level1: "Di Pulau Suara, kita akan mempelajari dasar-dasar VoIP. Ingat, VoIP mengubah suara menjadi data digital!",
            level2: "Sekarang kita di Kota Kabel! Di sini kamu akan belajar tentang perangkat-perangkat VoIP. Perhatikan perbedaan hardware dan software ya!",
            level3: "Menara Protokol menanti! Protokol adalah 'bahasa' yang digunakan perangkat VoIP untuk berkomunikasi.",
            level4: "Benteng Keamanan sangat penting! Tanpa keamanan yang baik, sistem VoIP bisa diserang oleh penjahat cyber.",
            level5: "Aula Aplikasi adalah level terakhir! Di sini kamu akan melihat bagaimana VoIP digunakan dalam kehidupan sehari-hari.",
            encouragement: ["Bagus sekali!", "Kamu hebat!", "Terus semangat!", "Jawaban yang tepat!", "Luar biasa!"],
            hints: [
                "Ingat, VoIP = Voice over Internet Protocol",
                "Pikirkan tentang perangkat yang kamu gunakan sehari-hari",
                "SIP untuk mengatur, RTP untuk mengirim data",
                "Keamanan selalu penting dalam teknologi",
                "VoIP ada di mana-mana di sekitar kita!"
            ]
        };

        // Initialize game
        function initGame() {
            createStars();
            showAIMessage(aiMessages.welcome);
        }

        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Avatar selection
        document.querySelectorAll('.avatar-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                gameState.playerAvatar = this.dataset.avatar;
            });
        });

        function startGame() {
            const name = document.getElementById('playerName').value;
            const playerClass = document.getElementById('playerClass').value;
            const difficulty = document.getElementById('difficulty').value;

            if (!name || !playerClass || !gameState.playerAvatar) {
                alert('Mohon lengkapi semua data!');
                return;
            }

            gameState.playerName = name;
            gameState.playerClass = playerClass;
            gameState.difficulty = difficulty;

            showScreen('introScreen');
            playSound('start');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');

            if (screenId !== 'setupScreen') {
                document.getElementById('scoreDisplay').style.display = 'block';
                updateScoreDisplay();
            }
        }

        function showLevelMap() {
            showScreen('levelMapScreen');
            updateProgress();
            updateLevelAccess();
        }

        function updateProgress() {
            const progress = (gameState.completedLevels.length / 5) * 100;
            document.getElementById('gameProgress').style.width = progress + '%';
        }

        function updateLevelAccess() {
            for (let i = 2; i <= 5; i++) {
                const levelCard = document.getElementById(`level${i}`);
                if (gameState.completedLevels.includes(i - 1)) {
                    levelCard.classList.remove('locked');
                    levelCard.onclick = () => startLevel(i);
                }
            }
        }

        function startLevel(levelNum) {
            if (levelNum > 1 && !gameState.completedLevels.includes(levelNum - 1)) {
                return;
            }

            gameState.currentLevel = levelNum;
            gameState.currentQuestionIndex = 0;
            
            showScreen('gameScreen');
            loadLevel(levelNum);
            showAIMessage(aiMessages[`level${levelNum}`]);
            playSound('levelStart');
        }

        function loadLevel(levelNum) {
            const level = levels[levelNum];
            document.getElementById('levelTitle').textContent = level.title;
            document.getElementById('materialContent').textContent = level.material;
            
            loadQuestion();
        }

        function loadQuestion() {
            const level = levels[gameState.currentLevel];
            const question = level.questions[gameState.currentQuestionIndex];
            
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('nextButton').style.display = 'none';
        }

        function selectAnswer(selectedIndex) {
            const level = levels[gameState.currentLevel];
            const question = level.questions[gameState.currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            
            options.forEach((option, index) => {
                option.onclick = null;
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex) {
                    option.classList.add('incorrect');
                }
            });
            
            if (selectedIndex === question.correct) {
                gameState.score += getDifficultyMultiplier() * 10;
                playSound('correct');
                showAIMessage(aiMessages.encouragement[Math.floor(Math.random() * aiMessages.encouragement.length)]);
            } else {
                playSound('incorrect');
                showAIMessage("Jangan menyerah! " + aiMessages.hints[gameState.currentLevel - 1]);
            }
            
            updateScoreDisplay();
            document.getElementById('nextButton').style.display = 'inline-block';
        }

        function nextQuestion() {
            gameState.currentQuestionIndex++;
            const level = levels[gameState.currentLevel];
            
            if (gameState.currentQuestionIndex >= level.questions.length) {
                completeLevel();
            } else {
                loadQuestion();
            }
        }

        function completeLevel() {
            if (!gameState.completedLevels.includes(gameState.currentLevel)) {
                gameState.completedLevels.push(gameState.currentLevel);
            }
            
            if (gameState.currentLevel === 5) {
                showFinalScreen();
            } else {
                showLevelMap();
                showAIMessage(`Level ${gameState.currentLevel} selesai! Lanjut ke level berikutnya!`);
            }
            
            playSound('levelComplete');
        }

        function showFinalScreen() {
            showScreen('finalScreen');
            document.getElementById('certificateName').textContent = gameState.playerName;
            document.getElementById('finalScore').textContent = gameState.score;
            playSound('victory');
        }

        function getDifficultyMultiplier() {
            switch (gameState.difficulty) {
                case 'easy': return 1;
                case 'medium': return 1.5;
                case 'hard': return 2;
                default: return 1;
            }
        }

        function updateScoreDisplay() {
            document.getElementById('currentScore').textContent = gameState.score;
            document.getElementById('currentLevel').textContent = gameState.currentLevel;
        }

        function toggleAISpeech() {
            const aiSpeech = document.getElementById('aiSpeech');
            aiSpeech.classList.toggle('show');
        }

        function showAIMessage(message) {
            document.getElementById('aiMessage').textContent = message;
            const aiSpeech = document.getElementById('aiSpeech');
            aiSpeech.classList.add('show');
            setTimeout(() => {
                aiSpeech.classList.remove('show');
            }, 4000);
        }

        function playSound(type) {
            // Sound effects would be implemented here
            // For now, we'll use visual feedback
            const aiCompanion = document.getElementById('aiCompanion');
            aiCompanion.style.transform = 'scale(1.2)';
            setTimeout(() => {
                aiCompanion.style.transform = 'scale(1)';
            }, 200);
        }

        function restartGame() {
            gameState = {
                playerName: '',
                playerClass: '',
                playerAvatar: '',
                difficulty: 'medium',
                currentLevel: 1,
                score: 0,
                completedLevels: [],
                currentQuestionIndex: 0
            };
            
            // Reset level access
            for (let i = 2; i <= 5; i++) {
                const levelCard = document.getElementById(`level${i}`);
                levelCard.classList.add('locked');
                levelCard.onclick = null;
            }
            
            showScreen('setupScreen');
            document.getElementById('scoreDisplay').style.display = 'none';
        }

        // Initialize the game when page loads
        window.onload = initGame;
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97275632c261e9d4',t:'MTc1NTc1MDAxNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
